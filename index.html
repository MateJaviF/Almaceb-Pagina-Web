<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mapa Interactivo</title>
    <style>
        .header.move-right {
            transform: translateX(280px); /* Only move enough to keep the braille button visible */
            transition: transform 0.3s ease;
        }
        .sidebar-menu {
            /* ...existing code... */
        }
        /* Ensure braille button is always on top when sidebar is open */
        .header-left {
            z-index: 101;
            background: #fff;
            border-radius: 50%;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }
        /* Sidebar menu styles */
        .sidebar-menu {
            position: fixed;
            top: 0;
            left: 0;
            width: 240px;
            height: 100vh;
            background: #fff;
            box-shadow: 2px 0 10px rgba(0,0,0,0.12);
            z-index: 100;
            transform: translateX(-100%);
            transition: transform 0.3s ease;
            display: flex;
            flex-direction: column;
            padding: 32px 16px 16px 16px;
            align-items: center;
        }
        .sidebar-menu.active {
            transform: translateX(0);
        }
        .sidebar-menu h3 {
            display: none;
        }
        .sidebar-menu ul {
            list-style: none;
            padding: 0;
            width: 100%;
        }
        .sidebar-menu ul li {
            margin-bottom: 18px;
        }
        .sidebar-menu ul li a {
            color: var(--text-color);
            text-decoration: none;
            font-size: 18px;
            transition: color 0.2s;
        }
        .sidebar-menu ul li a:hover {
            color: var(--primary-color);
        }
        .custom-marker {
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        :root {
            --primary-color: #4CAF50;
            --secondary-color: #2196F3;
            --background-light: #f5f5f5;
            --map-background: #e0e0e0;
            --road-color: #f7e7a5;
            --river-color: #a5d8ff;
            --text-color: #333;
        }

        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            width: 100vw;
            height: 100vh;
            min-height: 100vh;
            background-color: var(--background-light);
        }

        .container {
            width: 100vw;
            height: 100vh;
            max-width: 100vw;
            max-height: 100vh;
            border-radius: 0;
            border: none;
            box-shadow: none;
            overflow: hidden;
            position: relative;
            background-color: #fff;
            display: flex;
            flex-direction: column;
        }

        .header {
            display: flex;
            align-items: center;
            padding: 15px;
            background-color: #fff;
            border-bottom: 1px solid #eee;
            position: relative;
            z-index: 10;
        }

        .header-left {
            margin-right: 10px;
        }

        .header-left i {
            font-size: 24px;
            color: var(--text-color);
        }

        .search-bar {
            display: flex;
            flex-grow: 1;
            align-items: center;
            background-color: #f0f0f0;
            border-radius: 25px;
            padding: 8px 15px;
        }

        .search-bar i {
            color: #888;
            margin-right: 10px;
        }

        .search-bar input {
            border: none;
            background: transparent;
            outline: none;
            width: 100%;
            font-size: 16px;
        }

        .map-container {
            flex: 1 1 auto;
            width: 100%;
            position: relative;
            overflow: hidden;
            min-height: 0;
        }

        #map {
            width: 100%;
            height: 100%;
            min-height: 300px;
            background-color: var(--map-background);
            position: absolute;
            top: 0;
            left: 0;
            z-index: 1;
        }

        .sidebar-right {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            display: flex;
            flex-direction: column;
            gap: 15px;
            z-index: 10;
        }
        @media (max-width: 600px) {
            .header {
                padding: 10px;
            }
            .sidebar-right {
                right: 8px;
                gap: 10px;
            }
            .icon-button {
                width: 40px;
                height: 40px;
            }
            .icon-button i {
                font-size: 20px;
            }
        }

        .icon-button {
            background-color: #fff;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            cursor: pointer;
            transition: transform 0.2s;
        }

        .icon-button i {
            font-size: 24px;
            color: var(--text-color);
        }

        .icon-button:hover {
            transform: scale(1.1);
        }

        .icon-button:nth-child(2) i {
            color: red;
        }

        .icon-button:nth-child(3) i {
            color: var(--secondary-color);
        }

        .info-button {
            background-color: var(--primary-color);
        }

        .info-button i {
            color: #fff;
        }
    </style>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
        integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
</head>

<body>
    <div class="sidebar-menu" id="sidebarMenu">
        <img src="data/images/vendedora.png" alt="Avatar" style="width:80px;height:80px;border-radius:50%;margin-bottom:12px;box-shadow:0 2px 8px rgba(0,0,0,0.10);">
        <div style="font-size:20px;font-weight:600;color:#333;margin-bottom:24px;">Juana Rojas</div>
        <ul>
            <li><a href="data/config.html">Editar Perfil</a></li>
            <li><a href="Principal.html">Principal</a></li>
            <li><a href="data/business.html">Negocios Favoritos</a></li>
            <li><a href="data/troll.html">Cerrar sesión</a></li>
            <img src="data/images/QR-Code-Almaceb.jpg" alt="QR Code" height="240px" style="
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
            border-radius: 10px;">
        </ul>
    </div>
    <div class="container">
        <header class="header">
            <div class="header-left">
                <i class="fa-solid fa-braille"></i>
            </div>
            <div class="search-bar">
                <i class="fa-solid fa-magnifying-glass"></i>
                <input type="text" placeholder="Buscar...">
            </div>
        </header>
        <main class="map-container">
            <div id="map"></div>
        </main>
        <aside class="sidebar-right">
            <button onclick="window.location.href='Principal.html';" class="icon-button"><i class="fa-solid fa-house"></i></button>
            <button onclick="window.location.href='data/business.html';" class="icon-button"><i class="fa-solid fa-heart"></i></button>
            <button onclick="window.location.href='';" class="icon-button share-button"><i class="fa-solid fa-paper-plane"></i></button>
        </aside>
    </div>
    <script>
        const button = document.querySelector('share-button');
        button.addEventListener('click', (e) => {
            e.preventDefault();
            navigator.share({
                url: 'https://matejavif.github.io/Almaceb-Pagina-Web/',
                text: 'Te invitamos a visitar nuestro sitio web Almaceb',
                title: 'Google Site'
            })
        })
    </script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
        integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Sidebar menu toggle
            const brailleBtn = document.querySelector('.header-left i');
            const sidebarMenu = document.getElementById('sidebarMenu');
            brailleBtn.style.cursor = 'pointer';
            brailleBtn.addEventListener('click', () => {
                sidebarMenu.classList.toggle('active');
                document.querySelector('.header').classList.toggle('move-right', sidebarMenu.classList.contains('active'));
            });

            // 1. Inicializar el mapa
            // Coordenadas de San Rámon, Santiago de Chile
            let  initLat = -33.5532855;
            let initLng = -70.6528958;
            const map = L.map('map').setView([initLat, initLng], 17);

            // 2. Añadir una capa de tiles (mapa base) de OpenStreetMap
            L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
                maxZoom: 19,
                attribution: '© OpenStreetMap'
            }).addTo(map);

            // 3. Crear iconos personalizados para los marcadores
            const markerIcon = (imageUrl) => L.divIcon({
                className: 'custom-marker',
                html: `<img src="${imageUrl}" style="width: 100%; height: 100%; border-radius: 50%; object-fit: cover;">`,
                iconSize: [50, 50],
                iconAnchor: [25, 50],
                popupAnchor: [0, -45]
            });

            // 4. Datos dummy para los puntos de interés cerca de San Ramón
            const iconImage = "https://png.pngtree.com/png-vector/20190917/ourmid/pngtree-shop-location-store-navigation-pin-icon-png-image_1736160.jpg";
            const locations = [
  {
    coords: [-33.5532855, -70.6528958],
    name: 'Punto de Interés Central',
    image: iconImage,
    description: 'Punto de referencia inicial para el área.'
  },
  {
    coords: [-33.5489123, -70.6657432],
    name: 'Farmacia El Ahorro',
    image: iconImage,
    description: 'Farmacia con gran variedad de medicamentos y productos de cuidado personal. Ofrecen descuentos especiales.'
  },
  {
    coords: [-33.5617890, -70.6419876],
    name: 'Taller Mecánico El Motor',
    image: iconImage,
    description: 'Servicios de reparación y mantenimiento para todo tipo de vehículos. ¡Expertos en motores y frenos!'
  },
  {
    coords: [-33.5555432, -70.6784567],
    name: 'Tienda de Ropa La Moda',
    image: iconImage,
    description: 'Las últimas tendencias en moda para hombres y mujeres. Ven a renovar tu guardarropa.'
  },
  {
    coords: [-33.5428765, -70.6501234],
    name: 'Café La Taza Dorada',
    image: iconImage,
    description: 'Un lugar acogedor para disfrutar de un buen café y deliciosos pasteles. Ambiente tranquilo para trabajar o leer.'
  },
  {
    coords: [-33.5678901, -70.6587654],
    name: 'Supermercado El Mercado',
    image: iconImage,
    description: 'Amplio surtido de productos frescos, lácteos y abarrotes. ¡Todo lo que necesitas en un solo lugar!'
  },
  {
    coords: [-33.5501987, -70.6456789],
    name: 'Pizzería El Horno',
    image: iconImage,
    description: 'Pizzas artesanales con ingredientes frescos y el toque de la casa. ¡La mejor pizza de la zona!'
  },
  {
    coords: [-33.5587654, -70.6689012],
    name: 'Gimnasio El Músculo',
    image: iconImage,
    description: 'Modernas instalaciones y entrenadores personales para ayudarte a alcanzar tus metas de fitness.'
  },
  {
    coords: [-33.5456789, -70.6623456],
    name: 'Librería El Saber',
    image: iconImage,
    description: 'Gran selección de libros de todos los géneros, artículos de papelería y mucho más para los amantes de la lectura.'
  },
  {
    coords: [-33.5643210, -70.6554321],
    name: 'Heladería El Glaciar',
    image: iconImage,
    description: 'Los helados más refrescantes y con sabores únicos. ¡Perfecto para un día caluroso!'
  }
];

            // 5. Añadir los marcadores al mapa
            locations.forEach(location => {
                L.marker(location.coords, { icon: markerIcon(location.image) })
                    .addTo(map)
                    .bindPopup(`
                <b>${location.name}</b><br>${location.description}
            `);
            });

            // Localización en tiempo real del usuario
            let userMarker = null;
            if (navigator.geolocation) {
                navigator.geolocation.watchPosition(
                    (pos) => {
                        const lat = pos.coords.latitude;
                        const lng = pos.coords.longitude;
                        if (!userMarker) {
                            userMarker = L.marker([lat, lng], {
                                icon: L.icon({
                                    iconUrl: 'https://cdn-icons-png.flaticon.com/512/64/64113.png',
                                    iconSize: [32, 32],
                                    iconAnchor: [16, 32],
                                    popupAnchor: [0, -32]
                                })
                            }).addTo(map).bindPopup('¡Tu ubicación actual!').openPopup();
                            map.setView([lat, lng], 16);
                        } else {
                            userMarker.setLatLng([lat, lng]);
                        }
                    },
                    (err) => {
                        console.warn('Error obteniendo ubicación:', err);
                    },
                    { enableHighAccuracy: true, maximumAge: 10000, timeout: 20000 }
                );
            } else {
                console.warn('Geolocalización no soportada por este navegador.');
            }

        });
    </script>
</body>

</html>